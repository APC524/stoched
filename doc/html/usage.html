<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stoched: APC 524 Final Project: User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Stoched: APC 524 Final Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">User Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Installation</h3>
<p>First go to the <a href="https://github.com/APC524/stoched">download page</a> to get the latest distribution, if you have not downloaded <b>stoched</b> already.</p>
<h4>Download</h4>
<p>Download ZIP file at <a href="https://github.com/APC524/stoched"><b>stoched</b> Github</a> </p><pre class="fragment">$ unzip stoched-master.zip
$ cd stoched-master
</pre><h4>Clone Repository</h4>
<pre class="fragment">$ git clone https://github.com/APC524/stoched
$ cd stoched
</pre><h3>Getting Started</h3>
<h4>Step 1: Creating an input file</h4>
<p>The parser uses a custom language that is designed to be accessible to non-programmers. It uses minimal syntax and allows for line comments and end of line comments, and whitespace like new lines between commands. It has been designed to reduce the likelihood of redundant and potentially incorrect information.</p>
<p>A simple input file: </p><pre class="fragment">SETUP_VARS "a, b"
EVENT RATE "3" "a+1" "b+0"
EVENT RATE "a/3" "a-1" "b+0"

end
</pre><p>The first line initializes the variables in the simulation with a comma separated variable list enclosed in quotes. Variable names contain the characters A-Z, a-z, and 0-9. The first character, however must be A-Z or a-z. Note that underscores and spaces are not allowed and that the variable list must not contain spaces.</p>
<p>The next line is an event line. An input file can contain as many event lines as needed. In an abstract sense an event consists of the likelihood of the event occuring and a definition of how it changes the system when it occurs. Practically, an event is a rate function followed by any number of equations that involve the variables in the variable list. The rate function and following event functions can contain nonlinear expressions, support the mathematical symbols + - * / ( ), and can contain white space between symbols.</p>
<p>The last line is end. This indicates the end of the file</p>
<p>A more complicated input file with multiple, nonlinear events: </p><pre class="fragment">SETUP_VARS “a,b,c”
EVENT RATE “a” “a * (1 + c)” “b - 0.4” “0.56“
EVENT RATE “a*b/d” “a” “b-c” “a*b*c”

end
</pre><p>The number of variables and the number of events does not have to be the same. But the number of event functions per event must always equal the number of variables in the variable string. In this example there are three variables: a,b,c; therefore, there are always 4 equations in the EVENT. The first one is the rate function and the last three indicate how the three variables are modified. So the first event occurs at a rate equal to a, and when it occurs it sets a = a * (1 + c), it sets b = b - 0.4, and it sets c = 0.56.</p>
<p>Finer points: Note the syntax “a+1” and “a + 1” are both acceptable. Scientific notation is not yet supported</p>
<p>Lines can be commented by placing a # character. The parser ignores all text on a line after a # character. This means that it can be used to comment out a whole line if it is placed at the beginning of a line, or used to add a note at the end of a line</p>
<p>Comment Example: </p><pre class="fragment"># This code is now well commented
SETUP_VARS “a,b”
# EVENT RATE “2” “a - 5” “b - 5”
EVENT RATE “3” “a + 1” “b + 1”     #  I’ve added a comment here to explain why the rate is 3
end
</pre><p>In the above example the first event will be ignored because the line begins with #. When the second line is parsed, only the text “I’ve added …” is removed. This input file is functionally equivalent to the first example input file, but it is more readable by human because it had comments.</p>
<h4>Step 2: Running stoched</h4>
<h5>Compiling Serial Code</h5>
<pre class="fragment">stoched-master$ cd src
stoched-master/src$ make
</pre><h5>Sample Execution of Serial Code</h5>
<pre class="fragment">stoched-master$ cd examples
stoched-master/examples$ ../src/stoched.exe chem.parser.in init_file init_file.txt
</pre><h5>Compiling Parallel Code</h5>
<p>Assumes installation of OpenMPI </p><pre class="fragment">stoched-master$ cd src
stoched-master/src$ make parallel
</pre><h5>Sample Execution of Parallel Code</h5>
<p>For usage on Adroit.</p>
<p>Run_mpi.slurm, located in stoched/src: </p><pre class="fragment">#!/bin/bash
# Parallel job using 4 processors:
#SBATCH -N 1 
#SBATCH --ntasks-per-node=4
#SBATCH -t 0:03:00
#SBATCH --mail-type=begin
#SBATCH --mail-type=end
#SBATCH --mail-type=fail
#SBATCH --mail-user=kevinpg@princeton.edu 
# Load openmpi environment 
module load openmpi
# Make sure you are in the correct directory
cd ~/stoched/src/
# for nx in 128 256 512 
    # do                                                                                                                                                
    #    time ./heat_omp $nx 4 &gt; heat_omp.$nx.4.out
    #    gnuplot -e "outfile='heat_omp.$nx.4.out'" surf.plt
    #    time srun ./heat_mpi $nx &gt; heat_mpi.$nx.4.out
    #    gnuplot -e "outfile='heat_mpi.$nx.4.out'" surf.plt                                                                                                                                    
# done 

time srun -n 4 ./stoched_parallel.exe example.parser.in init_file init_file.txt n_realizations 100000 suppress_print 1 &gt; stoched_mpi.4.out
</pre><h5>Compiling Test Code</h5>
<p>Assumes installation of Google Test suite </p><pre class="fragment">stoched-master$ cd src
stoched-master/src$ make googletests
</pre><h5>Sample Execution of Test Code</h5>
<pre class="fragment">stoched-master$ cd src
stoched-master/src$ ./testmodel.exe
</pre><h4>Step 3: Parameters</h4>
<p>To specify additional parameters, the user may include additional command line arguments, which are listed below. For example, to run the simulation 5 times, the command would look like this: </p><pre class="fragment">stoched-master/src$ ./stoched.exe example.parser.in n_realizations 5
</pre><p>The command line arguments are as follows:</p>
<p><b>init_file</b>: Required for specifying the initial states data for most model definitions. The exception is a model definition with two species which each start with zero population. This is the default initial state.</p>
<p><b>method</b>: specifies which algorithm is used to perform computations. Specifying 0 will run the exact Gillespie algorithm, while 1 will run the Euler tau-leap method, and 2 will run the midpoint tau-leap method. Default is 0.</p>
<p><b>t_initial</b>: allows user to modify the starting time of the simulation. Default is 0 .</p>
<p><b>t_final</b>: allows user to modify the end time of the simulation. Default is 5000 .</p>
<p><b>timestep_size</b>: allows user to fix timestep size if desired.</p>
<p><b>n_realizations</b>: allows user to run the simulation multiple times with the same model and model conditions. Default value is 1.</p>
<p><b>max_iter</b>: allows user to specify maximum number of iterations. Default value is 100000000.</p>
<p><b>seed</b>: allows user to fix a seed of the random number generator (which allows for verification of consistency between multiple runs, and with external software results). The default value is 502.</p>
<p><b>out_path</b>: Allows user to specify an alternative output file path name. The default value is stoched_output, which will write to a file named stoched_output.txt . The extension is not required when specifying pathname.</p>
<p><b>suppress_print</b>: Option specified as either a 0 or 1. If 1, the software prints only the final value of the simulation to each output file. If 0 (default value), the software runs as usual, printing the results at each timestep. Specifying 1 results in significant speedup of the code. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
